"use strict";exports.id=392,exports.ids=[392],exports.modules={20392:(a,b,c)=>{c.d(b,{A:()=>A});var d=c(60687),e=c(29494),f=c(79964),g=c(95827);function h({title:a,value:b,icon:c,change:e}){return(0,d.jsxs)(g.Zp,{className:"bg-white rounded-lg shadow p-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,d.jsx)("h3",{className:"text-gray-500 text-sm font-medium",children:a}),(0,d.jsx)("span",{className:"text-primary-500",children:c})]}),(0,d.jsxs)("div",{className:"flex items-baseline",children:[(0,d.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:b}),e&&e]})]})}var i=c(73796),j=c(23026),k=c(23576),l=c(93508),m=c(17313),n=c(29113);function o({activities:a=[],isLoading:b}){return b?(0,d.jsxs)(g.Zp,{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,d.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[(0,d.jsx)("h2",{className:"text-lg font-medium text-gray-800",children:"Recent Activity"}),(0,d.jsx)("button",{className:"text-primary-600 hover:text-primary-800 text-sm font-medium",children:"View All"})]}),(0,d.jsx)("div",{className:"divide-y divide-gray-200",children:[1,2,3,4].map(a=>(0,d.jsxs)("div",{className:"px-6 py-4 flex items-start",children:[(0,d.jsx)(i.E,{className:"flex-shrink-0 w-12 h-12 rounded-md mr-4"}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)(i.E,{className:"h-5 w-3/4 mb-2"}),(0,d.jsx)(i.E,{className:"h-4 w-1/2"})]}),(0,d.jsx)(i.E,{className:"flex-shrink-0 h-4 w-16"})]},a))})]}):(0,d.jsxs)(g.Zp,{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,d.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[(0,d.jsx)("h2",{className:"text-lg font-medium text-gray-800",children:"Recent Activity"}),(0,d.jsx)("button",{className:"text-primary-600 hover:text-primary-800 text-sm font-medium",children:"View All"})]}),(0,d.jsx)("div",{className:"divide-y divide-gray-200",children:a.length>0?a.map((a,b)=>(0,d.jsxs)("div",{className:"px-6 py-4 flex items-start",children:[(0,d.jsx)("div",{className:`flex-shrink-0 ${(a=>{switch(a){case"visitor_request":case"room_update":default:return"bg-primary-100";case"billing_due":return"bg-warning-100";case"visitor_approved":return"bg-secondary-100"}})(a.type)} rounded-md p-2 mr-4`,children:(a=>{switch(a){case"visitor_request":default:return(0,d.jsx)(j.A,{className:"text-primary-600 w-5 h-5"});case"billing_due":return(0,d.jsx)(k.A,{className:"text-warning-600 w-5 h-5"});case"visitor_approved":return(0,d.jsx)(l.A,{className:"text-secondary-600 w-5 h-5"});case"room_update":return(0,d.jsx)(m.A,{className:"text-primary-600 w-5 h-5"})}})(a.type)}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(a=>{switch(a.type){case"visitor_request":return"New visitor request";case"billing_due":return"Billing reminder sent";case"visitor_approved":return"Visitor request approved";case"room_update":return"Room status updated";default:return"Activity recorded"}})(a)}),(0,d.jsx)("p",{className:"text-sm text-gray-500",children:(a=>{switch(a.type){case"visitor_request":return`${a.data.fullName} requested to visit ${a.data.resident?.fullName||"a resident"}`;case"billing_due":return`Billing for ${a.data.occupancy?.resident?.fullName||"a resident"} is due soon`;case"visitor_approved":return`${a.data.fullName} approved for visit`;case"room_update":return`Room ${a.data.unitNumber} status updated to ${a.data.status}`;default:return"No description available"}})(a)})]}),(0,d.jsx)("div",{className:"flex-shrink-0 text-sm text-gray-500",children:(a=>{try{return(0,n.m)(new Date(a),{addSuffix:!0})}catch(a){return"recently"}})(a.timestamp)})]},b)):(0,d.jsx)("div",{className:"px-6 py-8 text-center text-gray-500",children:(0,d.jsx)("p",{children:"No recent activity"})})})]})}var p=c(54050),q=c(14229),r=c(456),s=c(76288),t=c(537);function u({renewals:a=[],isLoading:b}){let{toast:c}=(0,t.dj)(),e=(0,p.n)({mutationFn:async a=>await (0,r.AT)("POST",`/api/billings/${a}/send-reminder`),onSuccess:()=>{c({title:"Reminder sent",description:"Billing reminder has been sent successfully"}),r.qQ.invalidateQueries({queryKey:["/api/billings/upcoming/30"]})},onError:a=>{c({title:"Failed to send reminder",description:a.message,variant:"destructive"})}});if(b)return(0,d.jsxs)(g.Zp,{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,d.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,d.jsx)("h2",{className:"text-lg font-medium text-gray-800",children:"Upcoming Renewals"})}),(0,d.jsx)("div",{className:"divide-y divide-gray-200 max-h-[420px] overflow-y-auto",children:[1,2,3,4].map(a=>(0,d.jsxs)("div",{className:"px-6 py-4",children:[(0,d.jsx)(i.E,{className:"h-5 w-3/4 mb-2"}),(0,d.jsx)(i.E,{className:"h-4 w-1/2 mb-3"}),(0,d.jsx)(i.E,{className:"h-8 w-32"})]},a))})]});let f=[...a].sort((a,b)=>new Date(a.dueDate).getTime()-new Date(b.dueDate).getTime());return(0,d.jsxs)(g.Zp,{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,d.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,d.jsx)("h2",{className:"text-lg font-medium text-gray-800",children:"Upcoming Renewals"})}),(0,d.jsx)("div",{className:"divide-y divide-gray-200 max-h-[420px] overflow-y-auto",children:f.length>0?f.map(a=>(0,d.jsxs)("div",{className:"px-6 py-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,d.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:a.occupancy?.resident?.fullName||"Unknown Resident"}),(0,d.jsx)("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${(a=>{let b=(0,s.c)(new Date(a),new Date);return b<=3||b<=7?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"})(a.dueDate)}`,children:(a=>{let b=(0,s.c)(new Date(a),new Date);return b<=0?"today":1===b?"1 day":`${b} days`})(a.dueDate)})]}),(0,d.jsxs)("p",{className:"text-xs text-gray-500",children:["Room ",a.occupancy?.room?.unitNumber||"N/A",",",a.occupancy?.room?.roomType?.replace("_"," ").replace(/\b\w/g,a=>a.toUpperCase())||"Unknown"]}),(0,d.jsxs)("p",{className:"text-xs font-medium text-gray-700 mt-1",children:["RM ",a.amount?.toLocaleString()||0]}),(0,d.jsx)("div",{className:"mt-2 flex",children:(0,d.jsx)(q.$,{variant:"outline",size:"sm",className:"text-xs bg-primary-50 text-primary-700 hover:bg-primary-100",onClick:()=>e.mutate(a.id),disabled:e.isPending,children:"Send Reminder"})})]},a.id)):(0,d.jsx)("div",{className:"px-6 py-8 text-center text-gray-500",children:(0,d.jsx)("p",{children:"No upcoming renewals"})})}),f.length>0&&(0,d.jsx)("div",{className:"px-6 py-3 bg-gray-50 text-right",children:(0,d.jsx)("button",{className:"text-sm font-medium text-primary-600 hover:text-primary-800",children:"View All Renewals"})})]})}var v=c(85254),w=c(41312),x=c(2975),y=c(32192),z=c(40228);function A(){let{user:a}=(0,v.As)(),{data:b,isLoading:c}=(0,e.I)({queryKey:["/api/dashboard/stats"]}),{data:g,isLoading:k}=(0,e.I)({queryKey:["/api/billings/upcoming/30"]});return(0,d.jsxs)(f.A,{title:"Dashboard",children:[(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsxs)("h1",{className:"text-2xl font-bold text-gray-800",children:["Welcome back, ",a?.fullName||"User"]}),(0,d.jsx)("p",{className:"text-gray-600",children:"Here's what's happening with your property today."})]}),(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:c?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.E,{className:"h-32 w-full rounded-lg"}),(0,d.jsx)(i.E,{className:"h-32 w-full rounded-lg"}),(0,d.jsx)(i.E,{className:"h-32 w-full rounded-lg"}),(0,d.jsx)(i.E,{className:"h-32 w-full rounded-lg"})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h,{title:"Total Residents",value:b?.residentCount||0,icon:(0,d.jsx)(w.A,{className:"h-6 w-6 text-primary"}),change:(0,d.jsxs)("span",{className:"ml-2 text-sm text-secondary-500 font-medium",children:[(0,d.jsx)(x.A,{className:"inline-block w-3 h-3"}),(0,d.jsx)("span",{children:"+4%"})]})}),(0,d.jsx)(h,{title:"Room Occupancy",value:`${b?.occupancyRate||0}%`,icon:(0,d.jsx)(y.A,{className:"h-6 w-6 text-primary"}),change:(0,d.jsxs)("span",{className:"ml-2 text-sm text-secondary-500 font-medium",children:[(0,d.jsx)(x.A,{className:"inline-block w-3 h-3"}),(0,d.jsx)("span",{children:"+2%"})]})}),(0,d.jsx)(h,{title:"Pending Renewals",value:b?.pendingRenewals||0,icon:(0,d.jsx)(z.A,{className:"h-6 w-6 text-warning-500"}),change:(0,d.jsx)("span",{className:"ml-2 text-sm text-gray-500 font-medium",children:"next 30 days"})}),(0,d.jsx)(h,{title:"Visitor Requests",value:b?.visitorRequests||0,icon:(0,d.jsx)(j.A,{className:"h-6 w-6 text-primary"}),change:(0,d.jsxs)("span",{className:"ml-2 text-sm text-destructive font-medium",children:[(0,d.jsx)("span",{className:"inline-block w-3 h-3",children:"!"}),(0,d.jsx)("span",{children:"Needs approval"})]})})]})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,d.jsx)("div",{className:"lg:col-span-2",children:(0,d.jsx)(o,{activities:b?.recentActivity||[],isLoading:c})}),(0,d.jsx)("div",{children:(0,d.jsx)(u,{renewals:g||[],isLoading:k})})]})]})}}};